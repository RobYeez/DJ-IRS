{"ast":null,"code":"import firebase from \"./firebase.js\"; //require('firebase/<PACKAGE>');\n//import { database } from \"firebase\";\n\nvar db = firebase.firestore();\nvar messaging = firebase.messaging(); // Add the public key generated from the console here.\n\nmessaging.usePublicVapidKey(\"BFVj_nB5KUhUpQbA1EYDPVHZIhs2awPNuZhM54OBS7bHk6DqYEmG6FRJdTurTS3Jp59OGCyA4RYTEcTBf1Hf5gY\");\nmessaging.requestPermission().then(function (permission) {\n  //have permission\n  if (permission === 'granted') {\n    console.log('Notification permission granted.'); // TODO(developer): Retrieve an Instance ID token for use with FCM.\n    // ...\n\n    return messaging.getToken();\n  } else {\n    console.log('Unable to get permission to notify.');\n  }\n}).then(function (token) {\n  //we have token\n  if (currentToken) {\n    sendTokenToServer(currentToken);\n    updateUIForPushEnabled(currentToken);\n  } else {\n    // Show permission request.\n    console.log('No Instance ID token available. Request permission to generate one.'); // Show permission UI.\n\n    updateUIForPushPermissionRequired();\n    setTokenSentToServer(false);\n  }\n}).catch(function (error) {\n  // Handle Errors here.\n  var errorCode = error.code;\n  var errorMessage = error.message; // ...\n\n  alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\n});\nmessaging.onMessage(function (payload) {\n  console.log(\"onMessage \", payload);\n});\nfirebase.auth().onAuthStateChanged(function (USER) {\n  var user = USER; //console.log(user);\n\n  if (user) {// User is signed in.\n  } else {// No user is signed in.\n    }\n});\nexport function GetUser() {\n  var user = firebase.auth().currentUser;\n  return user;\n}\nexport function GetUserData(currentComponent) {\n  var user = firebase.auth().currentUser;\n\n  if (user) {\n    var docRef = db.collection(\"users\").doc(user.uid);\n    docRef.get().then(function (doc) {\n      if (doc && doc.exists) {\n        //console.log(doc);\n        var data = doc.data(); //console.log(data);\n\n        currentComponent.setState({\n          User: user,\n          User_Loaded: true,\n          User_Firstname: data.User_Firstname,\n          User_Lastname: data.User_Lastname,\n          User_Email: data.User_Email,\n          User_Friends: data.User_Friends\n        });\n      }\n    }).catch(function (error) {\n      // Handle Errors here.\n      var errorCode = error.code;\n      var errorMessage = error.message; // ...\n\n      alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\n    });\n  } else {\n    currentComponent.setState({\n      User: null,\n      User_Loaded: false,\n      User_Firstname: \"\",\n      User_Lastname: \"\",\n      User_Email: \"\",\n      User_Friends: \"\"\n    });\n  }\n}\nexport function CreateUser(firstname, lastname, email, password, props) {\n  firebase.auth().createUserWithEmailAndPassword(email, password).then(function (cred) {\n    return db.collection(\"users\").doc(cred.user.uid).set({\n      User_Firstname: firstname,\n      User_Lastname: lastname,\n      User_Email: email,\n      User_Friends: []\n    });\n  }).then(function () {\n    //create user successful\n    alert(\"Created User\");\n    props.history.push(\"/userpage\");\n  }).catch(function (error) {\n    // Handle Errors here.\n    var errorCode = error.code;\n    var errorMessage = error.message; // ...\n\n    alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\n  });\n}\nexport function Login(email, password, props) {\n  firebase.auth().signInWithEmailAndPassword(email, password).then(function () {\n    //sign in successful\n    alert(\"Logged In\");\n    props.history.push(\"/userpage\");\n  }).catch(function (error) {\n    // Handle Errors here.\n    var errorCode = error.code;\n    var errorMessage = error.message; // ...\n\n    alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\n  });\n}\nexport function Logout(props) {\n  firebase.auth().signOut().then(function () {\n    // Sign-out successful.\n    alert(\"Logged Out\");\n    props.history.push(\"/login\");\n  }).catch(function (error) {\n    // An error happened.\n    var errorCode = error.code;\n    var errorMessage = error.message;\n    alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\n  });\n}","map":{"version":3,"sources":["D:\\Documents\\CS 180 Software Engineering\\DJ-IRS\\src\\UserFunctions.js"],"names":["firebase","db","firestore","messaging","usePublicVapidKey","requestPermission","then","permission","console","log","getToken","token","currentToken","sendTokenToServer","updateUIForPushEnabled","updateUIForPushPermissionRequired","setTokenSentToServer","catch","error","errorCode","code","errorMessage","message","alert","onMessage","payload","auth","onAuthStateChanged","USER","user","GetUser","currentUser","GetUserData","currentComponent","docRef","collection","doc","uid","get","exists","data","setState","User","User_Loaded","User_Firstname","User_Lastname","User_Email","User_Friends","CreateUser","firstname","lastname","email","password","props","createUserWithEmailAndPassword","cred","set","history","push","Login","signInWithEmailAndPassword","Logout","signOut"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,eAArB,C,CACA;AACA;;AAEA,IAAIC,EAAE,GAAGD,QAAQ,CAACE,SAAT,EAAT;AACA,IAAMC,SAAS,GAAGH,QAAQ,CAACG,SAAT,EAAlB,C,CAEA;;AACAA,SAAS,CAACC,iBAAV,CAA4B,yFAA5B;AACAD,SAAS,CAACE,iBAAV,GAA8BC,IAA9B,CAAmC,UAASC,UAAT,EAAqB;AACtD;AACA,MAAIA,UAAU,KAAK,SAAnB,EAA8B;AAC5BC,IAAAA,OAAO,CAACC,GAAR,CAAY,kCAAZ,EAD4B,CAE5B;AACA;;AACA,WAAON,SAAS,CAACO,QAAV,EAAP;AACD,GALD,MAKO;AACLF,IAAAA,OAAO,CAACC,GAAR,CAAY,qCAAZ;AACD;AAEF,CAXD,EAWGH,IAXH,CAWQ,UAASK,KAAT,EAAgB;AACtB;AACA,MAAIC,YAAJ,EAAkB;AAChBC,IAAAA,iBAAiB,CAACD,YAAD,CAAjB;AACAE,IAAAA,sBAAsB,CAACF,YAAD,CAAtB;AACD,GAHD,MAGO;AACL;AACAJ,IAAAA,OAAO,CAACC,GAAR,CAAY,qEAAZ,EAFK,CAGL;;AACAM,IAAAA,iCAAiC;AACjCC,IAAAA,oBAAoB,CAAC,KAAD,CAApB;AACD;AACF,CAvBD,EAuBGC,KAvBH,CAuBS,UAASC,KAAT,EAAgB;AACvB;AACA,MAAIC,SAAS,GAAGD,KAAK,CAACE,IAAtB;AACA,MAAIC,YAAY,GAAGH,KAAK,CAACI,OAAzB,CAHuB,CAIvB;;AAEAC,EAAAA,KAAK,CAAC,iBAAiBJ,SAAjB,GAA6B,IAA7B,GAAoCE,YAArC,CAAL;AACD,CA9BD;AAgCAlB,SAAS,CAACqB,SAAV,CAAoB,UAAUC,OAAV,EAAmB;AACrCjB,EAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BgB,OAA1B;AACD,CAFD;AAIAzB,QAAQ,CAAC0B,IAAT,GAAgBC,kBAAhB,CAAmC,UAASC,IAAT,EAAe;AAChD,MAAIC,IAAI,GAAGD,IAAX,CADgD,CAE9C;;AAEA,MAAIC,IAAJ,EAAU,CACR;AAGD,GAJD,MAIO,CACL;AACD;AACJ,CAXD;AAaA,OAAO,SAASC,OAAT,GAAmB;AACxB,MAAID,IAAI,GAAG7B,QAAQ,CAAC0B,IAAT,GAAgBK,WAA3B;AACA,SAAOF,IAAP;AACD;AAED,OAAO,SAASG,WAAT,CAAqBC,gBAArB,EAAuC;AAC5C,MAAIJ,IAAI,GAAG7B,QAAQ,CAAC0B,IAAT,GAAgBK,WAA3B;;AAEE,MAAGF,IAAH,EAAS;AACP,QAAIK,MAAM,GAAGjC,EAAE,CAACkC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2BP,IAAI,CAACQ,GAAhC,CAAb;AACAH,IAAAA,MAAM,CAACI,GAAP,GAAahC,IAAb,CAAmB,UAAS8B,GAAT,EAAc;AAC/B,UAAGA,GAAG,IAAIA,GAAG,CAACG,MAAd,EAAsB;AACpB;AACA,YAAMC,IAAI,GAAGJ,GAAG,CAACI,IAAJ,EAAb,CAFoB,CAGpB;;AACAP,QAAAA,gBAAgB,CAACQ,QAAjB,CAA2B;AACzBC,UAAAA,IAAI,EAAEb,IADmB;AAEzBc,UAAAA,WAAW,EAAE,IAFY;AAGzBC,UAAAA,cAAc,EAAEJ,IAAI,CAACI,cAHI;AAIzBC,UAAAA,aAAa,EAAEL,IAAI,CAACK,aAJK;AAKzBC,UAAAA,UAAU,EAAEN,IAAI,CAACM,UALQ;AAMzBC,UAAAA,YAAY,EAAEP,IAAI,CAACO;AANM,SAA3B;AAQD;AACF,KAdD,EAcG9B,KAdH,CAcS,UAASC,KAAT,EAAgB;AACvB;AACA,UAAIC,SAAS,GAAGD,KAAK,CAACE,IAAtB;AACA,UAAIC,YAAY,GAAGH,KAAK,CAACI,OAAzB,CAHuB,CAIvB;;AAEAC,MAAAA,KAAK,CAAC,iBAAiBJ,SAAjB,GAA6B,IAA7B,GAAoCE,YAArC,CAAL;AACD,KArBD;AAuBD,GAzBD,MAyBM;AACJY,IAAAA,gBAAgB,CAACQ,QAAjB,CAA2B;AACzBC,MAAAA,IAAI,EAAE,IADmB;AAEzBC,MAAAA,WAAW,EAAE,KAFY;AAGzBC,MAAAA,cAAc,EAAE,EAHS;AAIzBC,MAAAA,aAAa,EAAE,EAJU;AAKzBC,MAAAA,UAAU,EAAE,EALa;AAMzBC,MAAAA,YAAY,EAAE;AANW,KAA3B;AAQD;AAGJ;AAED,OAAO,SAASC,UAAT,CAAoBC,SAApB,EAA+BC,QAA/B,EAAyCC,KAAzC,EAAgDC,QAAhD,EAA0DC,KAA1D,EAAiE;AAChErD,EAAAA,QAAQ,CAAC0B,IAAT,GAAgB4B,8BAAhB,CAA+CH,KAA/C,EAAsDC,QAAtD,EAAgE9C,IAAhE,CAAqE,UAAAiD,IAAI,EAAI;AAC3E,WAAOtD,EAAE,CAACkC,UAAH,CAAc,OAAd,EAAuBC,GAAvB,CAA2BmB,IAAI,CAAC1B,IAAL,CAAUQ,GAArC,EAA0CmB,GAA1C,CAA8C;AACnDZ,MAAAA,cAAc,EAAEK,SADmC;AAEnDJ,MAAAA,aAAa,EAAEK,QAFoC;AAGnDJ,MAAAA,UAAU,EAAEK,KAHuC;AAInDJ,MAAAA,YAAY,EAAE;AAJqC,KAA9C,CAAP;AAOD,GARD,EAQGzC,IARH,CAQS,YAAW;AAChB;AACAiB,IAAAA,KAAK,CAAC,cAAD,CAAL;AACA8B,IAAAA,KAAK,CAACI,OAAN,CAAcC,IAAd,CAAmB,WAAnB;AACH,GAZD,EAYGzC,KAZH,CAYS,UAASC,KAAT,EAAgB;AACrB;AACA,QAAIC,SAAS,GAAGD,KAAK,CAACE,IAAtB;AACA,QAAIC,YAAY,GAAGH,KAAK,CAACI,OAAzB,CAHqB,CAIrB;;AAEAC,IAAAA,KAAK,CAAC,iBAAiBJ,SAAjB,GAA6B,IAA7B,GAAoCE,YAArC,CAAL;AAED,GApBH;AAqBP;AAED,OAAO,SAASsC,KAAT,CAAeR,KAAf,EAAsBC,QAAtB,EAAgCC,KAAhC,EAAuC;AAC1CrD,EAAAA,QAAQ,CAAC0B,IAAT,GAAgBkC,0BAAhB,CAA2CT,KAA3C,EAAkDC,QAAlD,EAA4D9C,IAA5D,CAAiE,YAAW;AAC1E;AACAiB,IAAAA,KAAK,CAAC,WAAD,CAAL;AACA8B,IAAAA,KAAK,CAACI,OAAN,CAAcC,IAAd,CAAmB,WAAnB;AAED,GALD,EAKGzC,KALH,CAKS,UAASC,KAAT,EAAgB;AACrB;AACA,QAAIC,SAAS,GAAGD,KAAK,CAACE,IAAtB;AACA,QAAIC,YAAY,GAAGH,KAAK,CAACI,OAAzB,CAHqB,CAIrB;;AAEAC,IAAAA,KAAK,CAAC,iBAAiBJ,SAAjB,GAA6B,IAA7B,GAAoCE,YAArC,CAAL;AACD,GAZH;AAcH;AAGD,OAAO,SAASwC,MAAT,CAAgBR,KAAhB,EAAuB;AAExBrD,EAAAA,QAAQ,CAAC0B,IAAT,GAAgBoC,OAAhB,GAA0BxD,IAA1B,CAA+B,YAAW;AACxC;AACAiB,IAAAA,KAAK,CAAC,YAAD,CAAL;AACA8B,IAAAA,KAAK,CAACI,OAAN,CAAcC,IAAd,CAAmB,QAAnB;AAED,GALD,EAKGzC,KALH,CAKS,UAASC,KAAT,EAAgB;AACvB;AACA,QAAIC,SAAS,GAAGD,KAAK,CAACE,IAAtB;AACA,QAAIC,YAAY,GAAGH,KAAK,CAACI,OAAzB;AACAC,IAAAA,KAAK,CAAC,iBAAiBJ,SAAjB,GAA6B,IAA7B,GAAoCE,YAArC,CAAL;AACD,GAVD;AAaL","sourcesContent":["import firebase from \"./firebase.js\";\r\n//require('firebase/<PACKAGE>');\r\n//import { database } from \"firebase\";\r\n\r\nvar db = firebase.firestore();\r\nconst messaging = firebase.messaging();\r\n\r\n// Add the public key generated from the console here.\r\nmessaging.usePublicVapidKey(\"BFVj_nB5KUhUpQbA1EYDPVHZIhs2awPNuZhM54OBS7bHk6DqYEmG6FRJdTurTS3Jp59OGCyA4RYTEcTBf1Hf5gY\");\r\nmessaging.requestPermission().then(function(permission) {\r\n  //have permission\r\n  if (permission === 'granted') {\r\n    console.log('Notification permission granted.');\r\n    // TODO(developer): Retrieve an Instance ID token for use with FCM.\r\n    // ...\r\n    return messaging.getToken();\r\n  } else {\r\n    console.log('Unable to get permission to notify.');\r\n  }\r\n  \r\n}).then(function(token) {\r\n  //we have token\r\n  if (currentToken) {\r\n    sendTokenToServer(currentToken);\r\n    updateUIForPushEnabled(currentToken);\r\n  } else {\r\n    // Show permission request.\r\n    console.log('No Instance ID token available. Request permission to generate one.');\r\n    // Show permission UI.\r\n    updateUIForPushPermissionRequired();\r\n    setTokenSentToServer(false);\r\n  }\r\n}).catch(function(error) {\r\n  // Handle Errors here.\r\n  var errorCode = error.code;\r\n  var errorMessage = error.message;\r\n  // ...\r\n\r\n  alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\r\n})\r\n\r\nmessaging.onMessage(function (payload) {\r\n  console.log(\"onMessage \", payload);\r\n});\r\n\r\nfirebase.auth().onAuthStateChanged(function(USER) {\r\n  var user = USER;\r\n    //console.log(user);\r\n\r\n    if (user) {\r\n      // User is signed in.\r\n        \r\n\r\n    } else {\r\n      // No user is signed in.\r\n    }\r\n});\r\n\r\nexport function GetUser() {\r\n  var user = firebase.auth().currentUser;\r\n  return user;\r\n}\r\n\r\nexport function GetUserData(currentComponent) {\r\n  var user = firebase.auth().currentUser;\r\n\r\n    if(user) {\r\n      var docRef = db.collection(\"users\").doc(user.uid);\r\n      docRef.get().then( function(doc) {\r\n        if(doc && doc.exists) {\r\n          //console.log(doc);\r\n          const data = doc.data();\r\n          //console.log(data);\r\n          currentComponent.setState( {\r\n            User: user,\r\n            User_Loaded: true,\r\n            User_Firstname: data.User_Firstname,\r\n            User_Lastname: data.User_Lastname,\r\n            User_Email: data.User_Email,\r\n            User_Friends: data.User_Friends,\r\n          });\r\n        }\r\n      }).catch(function(error) {\r\n        // Handle Errors here.\r\n        var errorCode = error.code;\r\n        var errorMessage = error.message;\r\n        // ...\r\n\r\n        alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\r\n      });\r\n      \r\n    }else {\r\n      currentComponent.setState( {\r\n        User: null,\r\n        User_Loaded: false,\r\n        User_Firstname: \"\",\r\n        User_Lastname: \"\",\r\n        User_Email: \"\",\r\n        User_Friends: \"\",\r\n      });\r\n    }\r\n    \r\n\r\n}\r\n\r\nexport function CreateUser(firstname, lastname, email, password, props) {\r\n        firebase.auth().createUserWithEmailAndPassword(email, password).then(cred => {\r\n          return db.collection(\"users\").doc(cred.user.uid).set({\r\n            User_Firstname: firstname,\r\n            User_Lastname: lastname,\r\n            User_Email: email,\r\n            User_Friends: [],\r\n          });\r\n          \r\n        }).then( function() {\r\n            //create user successful\r\n            alert(\"Created User\");\r\n            props.history.push(\"/userpage\");\r\n        }).catch(function(error) {\r\n            // Handle Errors here.\r\n            var errorCode = error.code;\r\n            var errorMessage = error.message;\r\n            // ...\r\n\r\n            alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\r\n\r\n          });\r\n}\r\n\r\nexport function Login(email, password, props) {\r\n    firebase.auth().signInWithEmailAndPassword(email, password).then(function() {\r\n      //sign in successful\r\n      alert(\"Logged In\");\r\n      props.history.push(\"/userpage\");\r\n      \r\n    }).catch(function(error) {\r\n        // Handle Errors here.\r\n        var errorCode = error.code;\r\n        var errorMessage = error.message;\r\n        // ...\r\n\r\n        alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\r\n      });\r\n      \r\n}\r\n\r\n\r\nexport function Logout(props) {\r\n    \r\n      firebase.auth().signOut().then(function() {\r\n        // Sign-out successful.\r\n        alert(\"Logged Out\");\r\n        props.history.push(\"/login\");\r\n        \r\n      }).catch(function(error) {\r\n        // An error happened.\r\n        var errorCode = error.code;\r\n        var errorMessage = error.message;\r\n        alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\r\n      });\r\n      \r\n      \r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}