{"ast":null,"code":"import firebase from \"./firebase.js\";\nvar db = firebase.firestore();\nvar messaging = firebase.messaging(); // Add the public key generated from the console here.\n\nmessaging.usePublicVapidKey(\"BFVj_nB5KUhUpQbA1EYDPVHZIhs2awPNuZhM54OBS7bHk6DqYEmG6FRJdTurTS3Jp59OGCyA4RYTEcTBf1Hf5gY\");\nNotification.requestPermission().then(function (permission) {\n  if (permission === 'granted') {\n    console.log('Notification permission granted.'); // TODO(developer): Retrieve an Instance ID token for use with FCM.\n    // ...\n  } else {\n    console.log('Unable to get permission to notify.');\n  }\n}); // Get Instance ID token. Initially this makes a network call, once retrieved\n// subsequent calls to getToken will return from cache.\n\nmessaging.getToken().then(function (currentToken) {\n  if (currentToken) {\n    sendTokenToServer(currentToken);\n    updateUIForPushEnabled(currentToken);\n  } else {\n    // Show permission request.\n    console.log('No Instance ID token available. Request permission to generate one.'); // Show permission UI.\n\n    updateUIForPushPermissionRequired();\n    setTokenSentToServer(false);\n  }\n}).catch(function (err) {\n  console.log('An error occurred while retrieving token. ', err);\n  showToken('Error retrieving Instance ID token. ', err);\n  setTokenSentToServer(false);\n});\nmessaging.onMessage(function (payload) {\n  console.log(\"onMessage \", payload);\n});\nfirebase.auth().onAuthStateChanged(function (USER) {\n  var user = USER; //console.log(user);\n\n  if (user) {// User is signed in.\n  } else {// No user is signed in.\n    }\n});\nexport function GetUser() {\n  var user = firebase.auth().currentUser;\n  return user;\n}\nexport function GetUserData(currentComponent) {\n  var user = firebase.auth().currentUser;\n\n  if (user) {\n    var docRef = db.collection(\"users\").doc(user.uid);\n    docRef.get().then(function (doc) {\n      if (doc && doc.exists) {\n        //console.log(doc);\n        var data = doc.data(); //console.log(data);\n\n        currentComponent.setState({\n          User: user,\n          User_Loaded: true,\n          User_Firstname: data.User_Firstname,\n          User_Lastname: data.User_Lastname,\n          User_Email: data.User_Email,\n          User_Friends: data.User_Friends\n        });\n      }\n    }).catch(function (error) {\n      // Handle Errors here.\n      var errorCode = error.code;\n      var errorMessage = error.message; // ...\n\n      alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\n    });\n  } else {\n    currentComponent.setState({\n      User: null,\n      User_Loaded: false,\n      User_Firstname: \"\",\n      User_Lastname: \"\",\n      User_Email: \"\",\n      User_Friends: \"\"\n    });\n  }\n}\nexport function CreateUser(firstname, lastname, email, password, props) {\n  firebase.auth().createUserWithEmailAndPassword(email, password).then(function (cred) {\n    return db.collection(\"users\").doc(cred.user.uid).set({\n      User_Firstname: firstname,\n      User_Lastname: lastname,\n      User_Email: email,\n      User_Friends: []\n    });\n  }).then(function () {\n    //create user successful\n    alert(\"Created User\");\n    props.history.push(\"/userpage\");\n  }).catch(function (error) {\n    // Handle Errors here.\n    var errorCode = error.code;\n    var errorMessage = error.message; // ...\n\n    alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\n  });\n}\nexport function Login(email, password, props) {\n  firebase.auth().signInWithEmailAndPassword(email, password).then(function () {\n    //sign in successful\n    alert(\"Logged In\");\n    props.history.push(\"/userpage\");\n  }).catch(function (error) {\n    // Handle Errors here.\n    var errorCode = error.code;\n    var errorMessage = error.message; // ...\n\n    alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\n  });\n}\nexport function Logout(props) {\n  firebase.auth().signOut().then(function () {\n    // Sign-out successful.\n    alert(\"Logged Out\");\n    props.history.push(\"/login\");\n  }).catch(function (error) {\n    // An error happened.\n    var errorCode = error.code;\n    var errorMessage = error.message;\n    alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\n  });\n}","map":{"version":3,"sources":["D:\\Documents\\CS 180 Software Engineering\\DJ-IRS\\src\\UserFunctions.js"],"names":["firebase","db","firestore","messaging","usePublicVapidKey","Notification","requestPermission","then","permission","console","log","getToken","currentToken","sendTokenToServer","updateUIForPushEnabled","updateUIForPushPermissionRequired","setTokenSentToServer","catch","err","showToken","onMessage","payload","auth","onAuthStateChanged","USER","user","GetUser","currentUser","GetUserData","currentComponent","docRef","collection","doc","uid","get","exists","data","setState","User","User_Loaded","User_Firstname","User_Lastname","User_Email","User_Friends","error","errorCode","code","errorMessage","message","alert","CreateUser","firstname","lastname","email","password","props","createUserWithEmailAndPassword","cred","set","history","push","Login","signInWithEmailAndPassword","Logout","signOut"],"mappings":"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","sourcesContent":["import firebase from \"./firebase.js\";\r\n\r\nvar db = firebase.firestore();\r\nconst messaging = firebase.messaging();\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// Add the public key generated from the console here.\r\nmessaging.usePublicVapidKey(\"BFVj_nB5KUhUpQbA1EYDPVHZIhs2awPNuZhM54OBS7bHk6DqYEmG6FRJdTurTS3Jp59OGCyA4RYTEcTBf1Hf5gY\");\r\nNotification.requestPermission().then(function(permission) {\r\n  if (permission === 'granted') {\r\n    console.log('Notification permission granted.');\r\n    // TODO(developer): Retrieve an Instance ID token for use with FCM.\r\n    // ...\r\n  } else {\r\n    console.log('Unable to get permission to notify.');\r\n  }\r\n});\r\n\r\n// Get Instance ID token. Initially this makes a network call, once retrieved\r\n// subsequent calls to getToken will return from cache.\r\nmessaging.getToken().then(function(currentToken) {\r\n  if (currentToken) {\r\n    sendTokenToServer(currentToken);\r\n    updateUIForPushEnabled(currentToken);\r\n  } else {\r\n    // Show permission request.\r\n    console.log('No Instance ID token available. Request permission to generate one.');\r\n    // Show permission UI.\r\n    updateUIForPushPermissionRequired();\r\n    setTokenSentToServer(false);\r\n  }\r\n}).catch(function(err) {\r\n  console.log('An error occurred while retrieving token. ', err);\r\n  showToken('Error retrieving Instance ID token. ', err);\r\n  setTokenSentToServer(false);\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nmessaging.onMessage(function (payload) {\r\n  console.log(\"onMessage \", payload);\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nfirebase.auth().onAuthStateChanged(function(USER) {\r\n  var user = USER;\r\n    //console.log(user);\r\n\r\n    if (user) {\r\n      // User is signed in.\r\n        \r\n\r\n    } else {\r\n      // No user is signed in.\r\n    }\r\n});\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport function GetUser() {\r\n  var user = firebase.auth().currentUser;\r\n  return user;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport function GetUserData(currentComponent) {\r\n  var user = firebase.auth().currentUser;\r\n\r\n    if(user) {\r\n      var docRef = db.collection(\"users\").doc(user.uid);\r\n      docRef.get().then( function(doc) {\r\n        if(doc && doc.exists) {\r\n          //console.log(doc);\r\n          const data = doc.data();\r\n          //console.log(data);\r\n          currentComponent.setState( {\r\n            User: user,\r\n            User_Loaded: true,\r\n            User_Firstname: data.User_Firstname,\r\n            User_Lastname: data.User_Lastname,\r\n            User_Email: data.User_Email,\r\n            User_Friends: data.User_Friends,\r\n          });\r\n        }\r\n      }).catch(function(error) {\r\n        // Handle Errors here.\r\n        var errorCode = error.code;\r\n        var errorMessage = error.message;\r\n        // ...\r\n\r\n        alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\r\n      });\r\n      \r\n    }else {\r\n      currentComponent.setState( {\r\n        User: null,\r\n        User_Loaded: false,\r\n        User_Firstname: \"\",\r\n        User_Lastname: \"\",\r\n        User_Email: \"\",\r\n        User_Friends: \"\",\r\n      });\r\n    }\r\n    \r\n\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport function CreateUser(firstname, lastname, email, password, props) {\r\n        firebase.auth().createUserWithEmailAndPassword(email, password).then(cred => {\r\n          return db.collection(\"users\").doc(cred.user.uid).set({\r\n            User_Firstname: firstname,\r\n            User_Lastname: lastname,\r\n            User_Email: email,\r\n            User_Friends: [],\r\n          });\r\n          \r\n        }).then( function() {\r\n            //create user successful\r\n            alert(\"Created User\");\r\n            props.history.push(\"/userpage\");\r\n        }).catch(function(error) {\r\n            // Handle Errors here.\r\n            var errorCode = error.code;\r\n            var errorMessage = error.message;\r\n            // ...\r\n\r\n            alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\r\n\r\n          });\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport function Login(email, password, props) {\r\n    firebase.auth().signInWithEmailAndPassword(email, password).then(function() {\r\n      //sign in successful\r\n      alert(\"Logged In\");\r\n      props.history.push(\"/userpage\");\r\n      \r\n    }).catch(function(error) {\r\n        // Handle Errors here.\r\n        var errorCode = error.code;\r\n        var errorMessage = error.message;\r\n        // ...\r\n\r\n        alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\r\n      });\r\n      \r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nexport function Logout(props) {\r\n    \r\n      firebase.auth().signOut().then(function() {\r\n        // Sign-out successful.\r\n        alert(\"Logged Out\");\r\n        props.history.push(\"/login\");\r\n        \r\n      }).catch(function(error) {\r\n        // An error happened.\r\n        var errorCode = error.code;\r\n        var errorMessage = error.message;\r\n        alert(\"Error Code: \" + errorCode + \"\\n\" + errorMessage);\r\n      });\r\n      \r\n      \r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}